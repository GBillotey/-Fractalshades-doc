<!== Adding "Fork me on Github" ribbon ==>
<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>fractalshades.projection &mdash; Fractalshades 1.1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/rtd_dark.css?v=e3debd14" />
      <link rel="stylesheet" type="text/css" href="../../_static/math.css?v=7fc59cab" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=58fbf978"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link href="../../_static/ribbon.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Fractalshades
              <img src="../../_static/logo3.jpg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html#installing">Installing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started.html#installing-gmp-mpfr-mpc-windows-users">Installing GMP / MPFR / MPC: Windows users</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started.html#installing-gmp-mpfr-mpc-unix-linux-users">Installing GMP / MPFR / MPC: Unix / Linux users</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started.html#installing-gmp-mpfr-mpc-mac-users">Installing GMP / MPFR / MPC: Mac users</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html#a-5-minutes-guide-to-fractalshades">A 5-minutes guide to fractalshades</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html#graphical-user-interface">Graphical user interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html#finding-areas-of-interest">Finding areas of interest</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html#unskewing-streched-areas">Unskewing streched areas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../math.html">Mathematical background</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../math.html#zoom-level-and-native-floating-point-precision">Zoom level and native floating-point precision</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math.html#perturbation-theory">Perturbation Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math.html#avoiding-loss-of-precision">Avoiding loss of precision</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math.html#billinear-approximations">Billinear approximations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math.html#extended-range-floating-points">Extended range floating points</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math.html#finding-minibrots">Finding minibrots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math.html#going-further-a-few-references">Going further: a few references</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Gallery</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#batch-mode-gallery">Batch mode gallery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#colormaps-template-gallery">Colormaps template gallery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#gui-mode-arbitrary-precision-implementations">GUI-mode: arbitrary precision implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#gui-mode-standard-implementation-examples">GUI-mode: standard implementation examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#lighting-examples-gallery">Lighting examples gallery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#projections">Projections</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/batch_mode/index.html">Batch mode gallery</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/01-full_basic.html">01 - Full Mandelbrot basic example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/02-bulb_fieldlines1.html">02 - Bulb fieldlines example “tint_or_shade”</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/03-bulb_fieldlines2.html">03 - Bulb fieldlines example “twinfield”</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/04-seahorse_shaded.html">04 - Seahorse shaded example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/05-seahorse_shaded_colored.html">05 - Seahorse shaded and colored example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/06-seahorse_interior.html">06 - Seahorse interior example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/07-seahorse_DEM.html">07 - Seahorse DEM example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/08-run_perturb_DEM.html">08 - DEM example with perturbation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/09-run_flake_DEM.html">09 - A deeper DEM example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/10-double_embedded_julia.html">10 - Double embedded Julia set</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/11-run_perturbdeep.html">11- Ultra-deep embedded Julia set</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/12-burning_ship_deep.html">12 - Burning Ship deep zoom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/13-burning_ship.html">13 - Burning ship DEM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/14-burning_ship-deeper_DEM.html">14 - Burning ship deeper DEM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/15-burning_ship-deepJulia_DEM.html">15 - Burning Ship ultra-deep embedded Julia set</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/16-tetration_spring.html">16 - Tetration (power tower) zoom: “Spring”</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/17-perpendicular_burning_ship_DEM.html">17 - “Perpendicular” Burning Ship</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/18-perpendicular_burning_ship_glynn.html">18 - “Perpendicular” Burning Ship: hidden Glynn spiral</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/19-perpendicular_burning_ship_Koch.html">19 - “Perpendicular” Burning Ship: hidden Koch snowflakes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/20-perpendicular_burning_ship_Sierpinski.html">20 - “Perpendicular” Burning Ship: hidden Sierpinski carpets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/21-perpendicular_burning_ship_trees.html">21 - “Perpendicular” Burning Ship: tree structures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/22-shark_fin_deep.html">22 - “Shark Fin” escape-time fractal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/batch_mode/23-deep_min.html">23 - A deep mini</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/colormaps/index.html">Colormaps template gallery</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/colormaps/plot_cmaps.html">Colormaps: available templates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/interactive_deepzoom/index.html">GUI-mode: arbitrary precision implementations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/interactive_deepzoom/D01_run_interactive.html">D01 - Mandelbrot arbitrary-precision explorer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/interactive_deepzoom/D02_run_BS_interactive.html">D02 - Burning Ship arbitrary-precision explorer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/interactive_deepzoom/D03_run_interactive_Mn.html">D03 - Mandelbrot arbitrary-precision explorer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/interactive_standard/index.html">GUI-mode: standard implementation examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/interactive_standard/S01_run_interactive_shallow.html">S01 - Mandelbrot explorer - Standard precision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/interactive_standard/S02_run_BS_shallow.html">S02 - Burning ship explorer - Standard precision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/interactive_standard/S03_run_interactive_Mn_shallow.html">S03 - Mandelbrot power n explorer - Standard precision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/interactive_standard/S04_run_collatz.html">S04 - Collatz explorer - Standard precision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/interactive_standard/S05_run_power_tower_shallow.html">S05 - Tetration fractal explorer - Standard precision</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/lighting/index.html">Lighting examples gallery</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/lighting/plot_lighting.html">Ligthings: available effects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/projections/index.html">Projections</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/projections/P01-feigenbaum_expmap.html">P01 - Exponential mapping: Feigenbaum point</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/projections/P02-inversion.html">P02 - Inversion of the Mandelbrot set</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/projections/P03-Elephant_valley_moebius.html">P03 - Moebius mapping: Elephant and Seahorse valleys</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/projections/P04-deep_expmap.html">P04 - Exponential mapping for deep zoom</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../API.html">Application Programming Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../API/settings.html">Application-level settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../API/settings.html#fractalshades.settings.enable_multithreading"><code class="docutils literal notranslate"><span class="pre">enable_multithreading</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/settings.html#fractalshades.settings.skip_calc"><code class="docutils literal notranslate"><span class="pre">skip_calc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/settings.html#fractalshades.settings.newton_zoom_level"><code class="docutils literal notranslate"><span class="pre">newton_zoom_level</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/settings.html#fractalshades.settings.no_newton"><code class="docutils literal notranslate"><span class="pre">no_newton</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/settings.html#fractalshades.settings.inspect_calc"><code class="docutils literal notranslate"><span class="pre">inspect_calc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/settings.html#fractalshades.settings.chunk_size"><code class="docutils literal notranslate"><span class="pre">chunk_size</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/settings.html#fractalshades.settings.verbosity"><code class="docutils literal notranslate"><span class="pre">verbosity</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/settings.html#fractalshades.settings.postproc_dtype"><code class="docutils literal notranslate"><span class="pre">postproc_dtype</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/settings.html#fractalshades.settings.log_directory"><code class="docutils literal notranslate"><span class="pre">log_directory</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/settings.html#fractalshades.settings.disable_decompression_size_check"><code class="docutils literal notranslate"><span class="pre">disable_decompression_size_check()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/settings.html#fractalshades.settings.BLA_compression"><code class="docutils literal notranslate"><span class="pre">BLA_compression</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/settings.html#fractalshades.settings.GUI_image_Mblimit"><code class="docutils literal notranslate"><span class="pre">GUI_image_Mblimit</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../API/core.html">Core components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../API/core.html#fractalshades.Fractal"><code class="docutils literal notranslate"><span class="pre">Fractal</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/core.html#fractalshades.Fractal.__init__"><code class="docutils literal notranslate"><span class="pre">Fractal.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/core.html#fractalshades.Fractal.clean_up"><code class="docutils literal notranslate"><span class="pre">Fractal.clean_up()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/core.html#fractalshades.Fractal.zoom"><code class="docutils literal notranslate"><span class="pre">Fractal.zoom()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/core.html#fractalshades.PerturbationFractal"><code class="docutils literal notranslate"><span class="pre">PerturbationFractal</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/core.html#fractalshades.PerturbationFractal.__init__"><code class="docutils literal notranslate"><span class="pre">PerturbationFractal.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/core.html#fractalshades.PerturbationFractal.zoom"><code class="docutils literal notranslate"><span class="pre">PerturbationFractal.zoom()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/core.html#fractalshades.Fractal_plotter"><code class="docutils literal notranslate"><span class="pre">Fractal_plotter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/core.html#fractalshades.Fractal_plotter.__init__"><code class="docutils literal notranslate"><span class="pre">Fractal_plotter.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/core.html#fractalshades.Fractal_plotter.add_layer"><code class="docutils literal notranslate"><span class="pre">Fractal_plotter.add_layer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/core.html#fractalshades.Fractal_plotter.plot"><code class="docutils literal notranslate"><span class="pre">Fractal_plotter.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/core.html#fractalshades.Fractal_plotter.save_db"><code class="docutils literal notranslate"><span class="pre">Fractal_plotter.save_db()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/core.html#fractalshades.zoom_options"><code class="docutils literal notranslate"><span class="pre">zoom_options()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/core.html#fractalshades.calc_options"><code class="docutils literal notranslate"><span class="pre">calc_options()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/core.html#fractalshades.interactive_options"><code class="docutils literal notranslate"><span class="pre">interactive_options()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../API/projection.html">Projections</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../API/projection.html#fractalshades.projection.Projection"><code class="docutils literal notranslate"><span class="pre">Projection</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/projection.html#fractalshades.projection.Projection.__init__"><code class="docutils literal notranslate"><span class="pre">Projection.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/projection.html#fractalshades.projection.Cartesian"><code class="docutils literal notranslate"><span class="pre">Cartesian</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/projection.html#fractalshades.projection.Cartesian.__init__"><code class="docutils literal notranslate"><span class="pre">Cartesian.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/projection.html#fractalshades.projection.Expmap"><code class="docutils literal notranslate"><span class="pre">Expmap</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/projection.html#fractalshades.projection.Expmap.__init__"><code class="docutils literal notranslate"><span class="pre">Expmap.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/projection.html#fractalshades.projection.Generic_mapping"><code class="docutils literal notranslate"><span class="pre">Generic_mapping</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/projection.html#fractalshades.projection.Generic_mapping.__init__"><code class="docutils literal notranslate"><span class="pre">Generic_mapping.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../API/arbitrary_models.html">Fractal models: Arbitrary-precision implementations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../API/arbitrary_models.html#fractalshades.models.Perturbation_mandelbrot"><code class="docutils literal notranslate"><span class="pre">Perturbation_mandelbrot</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/arbitrary_models.html#fractalshades.models.Perturbation_mandelbrot.__init__"><code class="docutils literal notranslate"><span class="pre">Perturbation_mandelbrot.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/arbitrary_models.html#fractalshades.models.Perturbation_mandelbrot.calc_std_div"><code class="docutils literal notranslate"><span class="pre">Perturbation_mandelbrot.calc_std_div()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/arbitrary_models.html#fractalshades.models.Perturbation_mandelbrot_N"><code class="docutils literal notranslate"><span class="pre">Perturbation_mandelbrot_N</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/arbitrary_models.html#fractalshades.models.Perturbation_mandelbrot_N.__init__"><code class="docutils literal notranslate"><span class="pre">Perturbation_mandelbrot_N.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/arbitrary_models.html#fractalshades.models.Perturbation_mandelbrot_N.calc_std_div"><code class="docutils literal notranslate"><span class="pre">Perturbation_mandelbrot_N.calc_std_div()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/arbitrary_models.html#fractalshades.models.Perturbation_burning_ship"><code class="docutils literal notranslate"><span class="pre">Perturbation_burning_ship</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/arbitrary_models.html#fractalshades.models.Perturbation_burning_ship.__init__"><code class="docutils literal notranslate"><span class="pre">Perturbation_burning_ship.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/arbitrary_models.html#fractalshades.models.Perturbation_burning_ship.calc_std_div"><code class="docutils literal notranslate"><span class="pre">Perturbation_burning_ship.calc_std_div()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../API/standard_models.html">Fractal models: Standard-precision implementations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Mandelbrot"><code class="docutils literal notranslate"><span class="pre">Mandelbrot</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Mandelbrot.__init__"><code class="docutils literal notranslate"><span class="pre">Mandelbrot.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Mandelbrot.calc_std_div"><code class="docutils literal notranslate"><span class="pre">Mandelbrot.calc_std_div()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Mandelbrot.newton_calc"><code class="docutils literal notranslate"><span class="pre">Mandelbrot.newton_calc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Mandelbrot_N"><code class="docutils literal notranslate"><span class="pre">Mandelbrot_N</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Mandelbrot_N.__init__"><code class="docutils literal notranslate"><span class="pre">Mandelbrot_N.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Mandelbrot_N.calc_std_div"><code class="docutils literal notranslate"><span class="pre">Mandelbrot_N.calc_std_div()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Mandelbrot_N.newton_calc"><code class="docutils literal notranslate"><span class="pre">Mandelbrot_N.newton_calc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Burning_ship"><code class="docutils literal notranslate"><span class="pre">Burning_ship</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Burning_ship.__init__"><code class="docutils literal notranslate"><span class="pre">Burning_ship.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Burning_ship.calc_std_div"><code class="docutils literal notranslate"><span class="pre">Burning_ship.calc_std_div()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Power_tower"><code class="docutils literal notranslate"><span class="pre">Power_tower</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Power_tower.__init__"><code class="docutils literal notranslate"><span class="pre">Power_tower.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Power_tower.newton_calc"><code class="docutils literal notranslate"><span class="pre">Power_tower.newton_calc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Collatz"><code class="docutils literal notranslate"><span class="pre">Collatz</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Collatz.__init__"><code class="docutils literal notranslate"><span class="pre">Collatz.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/standard_models.html#fractalshades.models.Collatz.base_calc"><code class="docutils literal notranslate"><span class="pre">Collatz.base_calc()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../API/postproc.html">Postprocessing fields</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Postproc_batch"><code class="docutils literal notranslate"><span class="pre">Postproc_batch</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Postproc_batch.__init__"><code class="docutils literal notranslate"><span class="pre">Postproc_batch.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Postproc_batch.add_postproc"><code class="docutils literal notranslate"><span class="pre">Postproc_batch.add_postproc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Postproc"><code class="docutils literal notranslate"><span class="pre">Postproc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Raw_pp"><code class="docutils literal notranslate"><span class="pre">Raw_pp</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Raw_pp.__init__"><code class="docutils literal notranslate"><span class="pre">Raw_pp.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Continuous_iter_pp"><code class="docutils literal notranslate"><span class="pre">Continuous_iter_pp</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Continuous_iter_pp.__init__"><code class="docutils literal notranslate"><span class="pre">Continuous_iter_pp.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Fieldlines_pp"><code class="docutils literal notranslate"><span class="pre">Fieldlines_pp</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Fieldlines_pp.__init__"><code class="docutils literal notranslate"><span class="pre">Fieldlines_pp.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.DEM_pp"><code class="docutils literal notranslate"><span class="pre">DEM_pp</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.DEM_pp.__init__"><code class="docutils literal notranslate"><span class="pre">DEM_pp.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.DEM_normal_pp"><code class="docutils literal notranslate"><span class="pre">DEM_normal_pp</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.DEM_normal_pp.__init__"><code class="docutils literal notranslate"><span class="pre">DEM_normal_pp.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Attr_pp"><code class="docutils literal notranslate"><span class="pre">Attr_pp</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Attr_pp.__init__"><code class="docutils literal notranslate"><span class="pre">Attr_pp.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Attr_normal_pp"><code class="docutils literal notranslate"><span class="pre">Attr_normal_pp</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Attr_normal_pp.__init__"><code class="docutils literal notranslate"><span class="pre">Attr_normal_pp.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Fractal_array"><code class="docutils literal notranslate"><span class="pre">Fractal_array</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/postproc.html#fractalshades.postproc.Fractal_array.__init__"><code class="docutils literal notranslate"><span class="pre">Fractal_array.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../API/layers.html">Image layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Virtual_layer"><code class="docutils literal notranslate"><span class="pre">Virtual_layer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Virtual_layer.__init__"><code class="docutils literal notranslate"><span class="pre">Virtual_layer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Virtual_layer.set_mask"><code class="docutils literal notranslate"><span class="pre">Virtual_layer.set_mask()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Bool_layer"><code class="docutils literal notranslate"><span class="pre">Bool_layer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Bool_layer.__init__"><code class="docutils literal notranslate"><span class="pre">Bool_layer.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Color_layer"><code class="docutils literal notranslate"><span class="pre">Color_layer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Color_layer.__init__"><code class="docutils literal notranslate"><span class="pre">Color_layer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Color_layer.overlay"><code class="docutils literal notranslate"><span class="pre">Color_layer.overlay()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Color_layer.set_mask"><code class="docutils literal notranslate"><span class="pre">Color_layer.set_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Color_layer.set_twin_field"><code class="docutils literal notranslate"><span class="pre">Color_layer.set_twin_field()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Color_layer.shade"><code class="docutils literal notranslate"><span class="pre">Color_layer.shade()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Normal_map_layer"><code class="docutils literal notranslate"><span class="pre">Normal_map_layer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Normal_map_layer.__init__"><code class="docutils literal notranslate"><span class="pre">Normal_map_layer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Normal_map_layer.set_mask"><code class="docutils literal notranslate"><span class="pre">Normal_map_layer.set_mask()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Grey_layer"><code class="docutils literal notranslate"><span class="pre">Grey_layer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Grey_layer.__init__"><code class="docutils literal notranslate"><span class="pre">Grey_layer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Grey_layer.set_mask"><code class="docutils literal notranslate"><span class="pre">Grey_layer.set_mask()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Disp_layer"><code class="docutils literal notranslate"><span class="pre">Disp_layer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Disp_layer.__init__"><code class="docutils literal notranslate"><span class="pre">Disp_layer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Disp_layer.set_mask"><code class="docutils literal notranslate"><span class="pre">Disp_layer.set_mask()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Blinn_lighting"><code class="docutils literal notranslate"><span class="pre">Blinn_lighting</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Blinn_lighting.__init__"><code class="docutils literal notranslate"><span class="pre">Blinn_lighting.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Blinn_lighting.add_light_source"><code class="docutils literal notranslate"><span class="pre">Blinn_lighting.add_light_source()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Overlay_mode"><code class="docutils literal notranslate"><span class="pre">Overlay_mode</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/layers.html#fractalshades.colors.layers.Overlay_mode.__init__"><code class="docutils literal notranslate"><span class="pre">Overlay_mode.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../API/colors.html">Color mapping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../API/colors.html#fractalshades.colors.Fractal_colormap"><code class="docutils literal notranslate"><span class="pre">Fractal_colormap</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/colors.html#fractalshades.colors.Fractal_colormap.__init__"><code class="docutils literal notranslate"><span class="pre">Fractal_colormap.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../API/GUI.html">GUI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../API/GUI.html#fractalshades.gui.guimodel.Fractal_GUI"><code class="docutils literal notranslate"><span class="pre">Fractal_GUI</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/GUI.html#fractalshades.gui.guimodel.Fractal_GUI.__init__"><code class="docutils literal notranslate"><span class="pre">Fractal_GUI.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/GUI.html#fractalshades.gui.guimodel.Fractal_GUI.connect_image"><code class="docutils literal notranslate"><span class="pre">Fractal_GUI.connect_image()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/GUI.html#fractalshades.gui.guimodel.Fractal_GUI.connect_mouse"><code class="docutils literal notranslate"><span class="pre">Fractal_GUI.connect_mouse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/GUI.html#fractalshades.gui.guimodel.Fractal_GUI.show"><code class="docutils literal notranslate"><span class="pre">Fractal_GUI.show()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/GUI.html#fractalshades.gui.guitemplates.std_zooming"><code class="docutils literal notranslate"><span class="pre">std_zooming</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/GUI.html#fractalshades.gui.guitemplates.std_zooming.__init__"><code class="docutils literal notranslate"><span class="pre">std_zooming.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../API/logging.html">Logging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../API/logging.html#fractalshades.log.set_log_handlers"><code class="docutils literal notranslate"><span class="pre">set_log_handlers()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../API/db.html">Databases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../API/db.html#fractalshades.db.Db"><code class="docutils literal notranslate"><span class="pre">Db</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/db.html#fractalshades.db.Db.__init__"><code class="docutils literal notranslate"><span class="pre">Db.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/db.html#fractalshades.db.Db.plot"><code class="docutils literal notranslate"><span class="pre">Db.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/db.html#fractalshades.db.Db.set_plotter"><code class="docutils literal notranslate"><span class="pre">Db.set_plotter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/db.html#fractalshades.db.Frame"><code class="docutils literal notranslate"><span class="pre">Frame</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/db.html#fractalshades.db.Frame.__init__"><code class="docutils literal notranslate"><span class="pre">Frame.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/db.html#fractalshades.db.Exp_db"><code class="docutils literal notranslate"><span class="pre">Exp_db</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/db.html#fractalshades.db.Exp_db.__init__"><code class="docutils literal notranslate"><span class="pre">Exp_db.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/db.html#fractalshades.db.Exp_db.plot"><code class="docutils literal notranslate"><span class="pre">Exp_db.plot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/db.html#fractalshades.db.Exp_frame"><code class="docutils literal notranslate"><span class="pre">Exp_frame</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/db.html#fractalshades.db.Exp_frame.__init__"><code class="docutils literal notranslate"><span class="pre">Exp_frame.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../API/movie.html">Movie module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../API/movie.html#fractalshades.movie.Movie"><code class="docutils literal notranslate"><span class="pre">Movie</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/movie.html#fractalshades.movie.Movie.__init__"><code class="docutils literal notranslate"><span class="pre">Movie.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/movie.html#fractalshades.movie.Movie.add_sequence"><code class="docutils literal notranslate"><span class="pre">Movie.add_sequence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/movie.html#fractalshades.movie.Movie.export_frame"><code class="docutils literal notranslate"><span class="pre">Movie.export_frame()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../API/movie.html#fractalshades.movie.Movie.make"><code class="docutils literal notranslate"><span class="pre">Movie.make()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/movie.html#fractalshades.movie.Camera_pan"><code class="docutils literal notranslate"><span class="pre">Camera_pan</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/movie.html#fractalshades.movie.Camera_pan.__init__"><code class="docutils literal notranslate"><span class="pre">Camera_pan.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/movie.html#fractalshades.movie.Camera_zoom"><code class="docutils literal notranslate"><span class="pre">Camera_zoom</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/movie.html#fractalshades.movie.Camera_zoom.__init__"><code class="docutils literal notranslate"><span class="pre">Camera_zoom.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../API/movie.html#fractalshades.movie.Custom_sequence"><code class="docutils literal notranslate"><span class="pre">Custom_sequence</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../API/movie.html#fractalshades.movie.Custom_sequence.__init__"><code class="docutils literal notranslate"><span class="pre">Custom_sequence.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../making_movies.html">Making movies</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../making_movies.html#example-pan-sequence">Example: pan sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../making_movies.html#example-zoom-sequence">Example: zoom sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../making_movies.html#example-custom-zoom-sequence">Example: “Custom” zoom sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../making_movies.html#example-using-distance-estimation-plots">Example: Using Distance Estimation plots</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#rev-1-1">Rev 1.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-1-1-0">Rev 1.1.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-1-1-1">Rev 1.1.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#rev-1-0">Rev 1.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-1-0-3">Rev 1.0.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-1-0-2">Rev 1.0.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-1-0-1">Rev 1.0.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-1-0-0">Rev 1.0.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#rev-0-5">Rev 0.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-0-5-6">Rev 0.5.6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-0-5-5">Rev 0.5.5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-0-5-4">Rev 0.5.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-0-5-3">Rev 0.5.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-0-5-2">Rev 0.5.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-0-5-0">Rev 0.5.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#rev-0-4">Rev 0.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-0-4-3">Rev 0.4.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-0-4-2">Rev 0.4.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#rev-0-4-1">Rev 0.4.1</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgment.html">Acknowledgment</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Fractalshades</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">fractalshades.projection</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">

           <div itemprop="articleBody">
             
  <h1>Source code for fractalshades.projection</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numba</span>
<span class="kn">import</span> <span class="nn">mpmath</span>

<span class="kn">import</span> <span class="nn">fractalshades</span> <span class="k">as</span> <span class="nn">fs</span>
<span class="kn">import</span> <span class="nn">fractalshades.settings</span>
<span class="kn">import</span> <span class="nn">fractalshades.numpy_utils.xrange</span> <span class="k">as</span> <span class="nn">fsx</span>


<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Log attributes</span>
<span class="c1"># https://docs.python.org/2/library/logging.html#logrecord-attributes</span>

<div class="viewcode-block" id="Projection">
<a class="viewcode-back" href="../../API/projection.html#fractalshades.projection.Projection">[docs]</a>
<span class="k">class</span> <span class="nc">Projection</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Projection defines a mapping acting on the screen-pixels before</span>
<span class="sd">    iteration.</span>
<span class="sd">    It implements the associated modifications of the derivatives, when</span>
<span class="sd">    needed (for distance estimation or shading).</span>

<span class="sd">    For a `xy_ratio` - zoom parameter - equal to 1, screen pixels are defined</span>
<span class="sd">    in :math:`[0.5, 0.5] \\times [-0.5, 0.5]`</span>
<span class="sd">    </span>
<span class="sd">    More generally, the screen is a</span>
<span class="sd">    rectangle and pixel coordinates take values in:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>

<span class="sd">        [0.5, 0.5] \\times \\left[ -\\frac{0.5}{xy\\_ratio},</span>
<span class="sd">        \\frac{0.5}{xy\\_ratio} \\right]</span>

<span class="sd">    The projection is defined as:</span>
<span class="sd">        </span>
<span class="sd">    .. math::</span>

<span class="sd">        (\\bar{x}_{pix}, \\bar{y}_{pix}) =  f(x_{pix}, y_{pix})</span>
<span class="sd">    </span>
<span class="sd">    or alternatively with complex notations:</span>
<span class="sd">        </span>
<span class="sd">    .. math::</span>

<span class="sd">        \\bar{z}_{pix} =  f(z_{pix})</span>

<span class="sd">    Derived classes shall implement the actual  :math:`f` function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">init_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Return a dict of parameters used during __init__ call&quot;&quot;&quot;</span>
        <span class="n">init_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="p">(</span>
            <span class="n">p_name</span><span class="p">,</span> <span class="n">param</span>
        <span class="p">)</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># By contract, __init__ params shall be stored as instance attrib.</span>
            <span class="c1"># (&#39;Projection&#39; interface)</span>
            <span class="n">init_kwargs</span><span class="p">[</span><span class="n">p_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">init_kwargs</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        2 `Projections` are equal if:</span>

<span class="sd">            - they are instances from the same subclass</span>
<span class="sd">            - they have been created with the same init_kwargs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span>
            <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">init_kwargs</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_kwargs</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">adjust_to_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fractal</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Some projection might impose constraints on the xy_ratio&quot;&quot;&quot;</span>
        <span class="c1"># Default implementation: does nothing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_impl</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">make_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_f_impl</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_df_impl</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_dfBS_impl</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; complex to complex mapping &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Derived classes shall implement&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_df_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; complex to complex mapping &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Derived classes shall implement&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_dfBS_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; complex to 4 floats mapping &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Derived classes shall implement&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">df_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Used in to Perturbation fractal as a corrective</span>
<span class="sd">        scaling factor used in dZndC computation (and consequently distance</span>
<span class="sd">        estimation, ...)</span>
<span class="sd">        Projections supporting arbitray precision shall implement.</span>

<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        df_scale: numba compiled function pix -&gt; scaling or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Arbitray precision not supported by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bounding_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy_ratio</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Passed to Perturbation fractal as an enveloppe of the mapping of</span>
<span class="sd">        the pixels (before general scaling `scale`)</span>
<span class="sd">        Projections supporting arbitray precision shall implement.</span>

<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        w, h: floats, width and height of the bounding box</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># proj_dx = self.dx * self.projection.scale</span>
        <span class="c1"># corner_a = lin_proj_impl_noscale(0.5 * (w + 1j * h)) * proj_dx</span>
        <span class="c1"># corner_a is absolute the distance to center</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Arbitray precision not implemented for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">min_local_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Used in to Perturbation fractal to define min pix size. Minimum of</span>
<span class="sd">        local |df| (before general scaling `scale`)</span>
<span class="sd">        Projections supporting arbitray precision shall implement.</span>

<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        scale: mpmath.mpf or float, the scale factor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pix = proj.min_local_scale * proj.scale * (f.dx / f.nx)</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Arbitray precision not supported by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span></div>


<span class="c1"># Development notes: Projections and derivatives / normals</span>
<span class="c1"># For perturbation fractals, the derivatives are relative to a &quot;window&quot; scale</span>
<span class="c1"># dx (in Cartesian mode). This scale become dx * projection.scale (constant</span>
<span class="c1"># real scalar) for non-cartesian projections.</span>
<span class="c1"># On top of this general scaling, 2 &quot;local&quot; modifiers may be implemented </span>
<span class="c1"># - total derivative (account for variable local scaling + rotation + skew)</span>
<span class="c1">#   (mandatory)</span>
<span class="c1"># - derivative &quot;without rotation&quot; useful if the final aim is to unwrap, for</span>
<span class="c1">#   instance to make a videofrom a expmap (optionnal)</span>

<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="Cartesian">
<a class="viewcode-back" href="../../API/projection.html#fractalshades.projection.Cartesian">[docs]</a>
<span class="k">class</span> <span class="nc">Cartesian</span><span class="p">(</span><span class="n">Projection</span><span class="p">):</span>
<div class="viewcode-block" id="Cartesian.__init__">
<a class="viewcode-back" href="../../API/projection.html#fractalshades.projection.Cartesian.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expmap_seam</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A Cartesian projection. This is simply the identity function:</span>

<span class="sd">        .. math::</span>

<span class="sd">            \\bar{z}_{pix} =  z_{pix}</span>

<span class="sd">        This class can be used with arbitrary-precision deep zooms.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        `expmap_seam`: None | float</span>
<span class="sd">            If not None, will ensure a smooth transition between cartesian and</span>
<span class="sd">            exponential projections (by simulating the scaling a Expmap applies</span>
<span class="sd">            to the derivatives). The `expmap_seam` value shall usually be set</span>
<span class="sd">            at 1.0, if the Expmap projection `dx` is half of the Cartesian</span>
<span class="sd">            projection `dx` (ie, the reference diameter of the Expmap matches</span>
<span class="sd">            the reference width of the cartesian mapping).</span>
<span class="sd">            Otherwise, it is an additionnal scaling factor.</span>
<span class="sd">            Note: parameter only valid for arbitrary-precision implementations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expmap_seam</span> <span class="o">=</span> <span class="n">expmap_seam</span>
        <span class="k">if</span> <span class="n">expmap_seam</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">make_dzndc_modifier</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">make_f_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; A cartesian projection just let pass-through the coordinates&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">cartesian_numba_impl</span>

    <span class="k">def</span> <span class="nf">make_df_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">make_dfBS_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dfBS</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">df_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">bounding_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy_ratio</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">xy_ratio</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">min_local_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.</span>

    <span class="k">def</span> <span class="nf">make_dzndc_modifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Applies the scaling part of exp mapping at end of iteration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">expmap_seam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expmap_seam</span>
        <span class="c1"># Development notes</span>
        <span class="c1"># Expmap at h=0 -&gt; kdiff_proj = expmap_seam, pixabs_proj = expmap_seam / 2</span>
        <span class="c1"># Cartesian     -&gt; kdiff_proj = 1.,          pixabs_proj = 1.</span>

        <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">cpix</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cpix</span> <span class="o">+</span> <span class="mf">1.e-6</span><span class="p">)</span> <span class="o">*</span> <span class="n">expmap_seam</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dzndc_modifier</span> <span class="o">=</span> <span class="n">numba_impl</span></div>




<span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">cartesian_numba_impl</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">z</span>

<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="Expmap">
<a class="viewcode-back" href="../../API/projection.html#fractalshades.projection.Expmap">[docs]</a>
<span class="k">class</span> <span class="nc">Expmap</span><span class="p">(</span><span class="n">Projection</span><span class="p">):</span>
<div class="viewcode-block" id="Expmap.__init__">
<a class="viewcode-back" href="../../API/projection.html#fractalshades.projection.Expmap.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hmin</span><span class="p">,</span> <span class="n">hmax</span><span class="p">,</span> <span class="n">rotates_df</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        An exponential projection will map :math:`z_{pix}` as follows:</span>

<span class="sd">        .. math::</span>
<span class="sd">            \\bar{z}_{pix} = \\exp(h_{moy}) \\cdot \\exp(dh \\cdot z_{pix}) </span>

<span class="sd">        where:</span>

<span class="sd">        .. math::</span>
<span class="sd">            h_{moy} &amp;= \\frac{1}{2} \\cdot (h_{min} + h_{max}) \\\\</span>
<span class="sd">            dh &amp;= h_{max} - h_{min}</span>

<span class="sd">        This class can be used with arbitrary-precision deep zooms.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        hmin: str or float or mpmath.mpf</span>
<span class="sd">            scaling at the lower end of the h-axis, hmin &gt;= 0.</span>
<span class="sd">        hmax: str or float or mpmath.mpf</span>
<span class="sd">            scaling at the higher end of the h-axis, hmax &gt; hmin</span>
<span class="sd">        rotates_df: bool</span>
<span class="sd">            If ``True`` (default), the derivative will be scaled but also</span>
<span class="sd">            rotated according to the mapping. If ``False``, only the scaling</span>
<span class="sd">            will be taken into account.</span>
<span class="sd">            A rule of thumb is this value shall be set to ``True``</span>
<span class="sd">            for a standalone picture, and to ``False`` if used as input for a</span>
<span class="sd">            movie making tool.</span>
<span class="sd">        orientation: &quot;horizontal&quot; | &quot;vertical&quot;</span>
<span class="sd">            The direction for the h axis. Defaults to &quot;horizontal&quot;.</span>

<span class="sd">        Notes</span>
<span class="sd">        =====</span>
<span class="sd">        .. note::</span>
<span class="sd">            *Adjustment of zoom parameters:*</span>
<span class="sd">            The `xy_ratio` of the zoom will be adjusted (at runtime) to</span>
<span class="sd">            ensure that :math:`\\bar{y}_{pix}` extends from :math:`- \\pi`</span>
<span class="sd">            to :math:`\\pi`. `nx` is interpreted as `nh` for all values of the</span>
<span class="sd">            `direction` parameter (&quot;horizontal&quot; or &quot;vertical&quot;).</span>

<span class="sd">        .. note::</span>
<span class="sd">            *Large mappings and computation by steps:*</span>
<span class="sd">            For large exponentional mappings which may cover several orders of</span>
<span class="sd">            magnitude, computation will be run by steps. Each step:</span>

<span class="sd">                - reuses the same reference orbit</span>
<span class="sd">                - updates the BLA table as needed by the scale</span>
<span class="sd">                - updates the reference size used to avoid overflows in</span>
<span class="sd">                  derivatives</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">hmin</span> <span class="o">&lt;</span> <span class="n">hmax</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Provide hmin, hmax with:  0 &lt;= hmin &lt; hmax for Expmap&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_step</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numba_step_implemented</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotates_df</span> <span class="o">=</span> <span class="n">rotates_df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="n">orientation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">premul_1j</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;horizontal&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;vertical&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}[</span><span class="n">orientation</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">mpmath</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">hmax</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">fs</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">xrange_zoom_level</span><span class="p">):</span>
            <span class="c1"># Or ~ hmax &gt; 690... We store internally as Xrange</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hmin</span> <span class="o">=</span> <span class="n">fsx</span><span class="o">.</span><span class="n">mpf_to_Xrange</span><span class="p">(</span><span class="n">hmin</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hmax</span> <span class="o">=</span> <span class="n">fsx</span><span class="o">.</span><span class="n">mpf_to_Xrange</span><span class="p">(</span><span class="n">hmax</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># We store internally as float</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hmin</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">hmin</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hmax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">hmax</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hmoy</span> <span class="o">=</span> <span class="p">(</span><span class="n">hmin</span> <span class="o">+</span> <span class="n">hmax</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dh</span> <span class="o">=</span> <span class="n">hmax</span> <span class="o">-</span> <span class="n">hmin</span></div>


    <span class="k">def</span> <span class="nf">nh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fractal</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">fractal</span><span class="o">.</span><span class="n">ny</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">premul_1j</span> <span class="k">else</span> <span class="n">fractal</span><span class="o">.</span><span class="n">nx</span>

    <span class="k">def</span> <span class="nf">nt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fractal</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">fractal</span><span class="o">.</span><span class="n">nx</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">premul_1j</span> <span class="k">else</span> <span class="n">fractal</span><span class="o">.</span><span class="n">ny</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pix_to_ht</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Factor that transforms a pixel to ht coordinates</span>
<span class="sd">        Note: 0 (scling 1.) is centered</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dh</span>
        <span class="n">premul_1j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">premul_1j</span>
        <span class="n">xy_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_ratio</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">dh</span> <span class="o">*</span> <span class="n">xy_ratio</span><span class="p">)</span> <span class="k">if</span> <span class="n">premul_1j</span> <span class="k">else</span> <span class="n">dh</span>


    <span class="k">def</span> <span class="nf">set_exp_zoom_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exp_step_hmax</span><span class="p">,</span> <span class="n">exp_step_hmin</span><span class="p">):</span>
        <span class="c1"># property defined in ``save_db`` with exp_zoom_step set</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;set_exp_zoom_step: </span><span class="si">{</span><span class="n">exp_step_hmin</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">exp_step_hmax</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;for a full range of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">hmin</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">hmax</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_step_hmax</span> <span class="o">=</span> <span class="n">exp_step_hmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_step_hmin</span> <span class="o">=</span> <span class="n">exp_step_hmin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_step_hmoy</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">exp_step_hmax</span> <span class="o">+</span> <span class="n">exp_step_hmin</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_step_dh</span> <span class="o">=</span> <span class="p">(</span><span class="n">exp_step_hmax</span> <span class="o">-</span> <span class="n">exp_step_hmin</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_step</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">make_dzndc_modifier</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numba_step_implemented</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">make_df_impl</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">make_dfBS_impl</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">del_exp_zoom_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; property used in ``save_db`` with exp_zoom_step set &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_step</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_df_impl</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_dfBS_impl</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">adjust_to_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fractal</span><span class="p">):</span>
        <span class="c1"># We need to adjust the fractal xy_ratio in order to match hmax - hmin</span>
        <span class="c1"># target: dh = 2. * np.pi * xy_ratio </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">premul_1j</span><span class="p">:</span>
            <span class="n">xy_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dh</span>
            <span class="n">nx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fractal</span><span class="o">.</span><span class="n">nx</span> <span class="o">*</span> <span class="n">xy_ratio</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xy_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dh</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span><span class="p">)</span>
            <span class="n">nx</span> <span class="o">=</span> <span class="n">fractal</span><span class="o">.</span><span class="n">nx</span>

        <span class="n">fractal</span><span class="o">.</span><span class="n">xy_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_ratio</span> <span class="o">=</span> <span class="n">xy_ratio</span>
        <span class="n">fractal</span><span class="o">.</span><span class="n">zoom_kwargs</span><span class="p">[</span><span class="s2">&quot;xy_ratio&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xy_ratio</span>
        <span class="n">fractal</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="n">nx</span>
        <span class="n">fractal</span><span class="o">.</span><span class="n">zoom_kwargs</span><span class="p">[</span><span class="s2">&quot;nx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nx</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Adjusted parameters for Expmap projection:</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;zoom parameter nx: </span><span class="si">{</span><span class="n">fractal</span><span class="o">.</span><span class="n">nx</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;zoom parameter xy_ratio: </span><span class="si">{</span><span class="n">fractal</span><span class="o">.</span><span class="n">xy_ratio</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_impl</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_dzndc_modifier</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">make_f_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; apply the full transform &quot;&quot;&quot;</span>
        <span class="n">hmoy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hmoy</span>
        <span class="n">pix_to_ht</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pix_to_ht</span>

        <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">pix</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">hmoy</span> <span class="o">+</span> <span class="n">pix_to_ht</span> <span class="o">*</span> <span class="n">pix</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">numba_impl</span>


    <span class="k">def</span> <span class="nf">make_df_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Rotate the derivatives of the transform, according to the options</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_step</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_df_impl_step</span><span class="p">()</span>
        <span class="n">pix_to_ht</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pix_to_ht</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotates_df</span><span class="p">:</span>
            <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">pix</span><span class="p">):</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pix_to_ht</span> <span class="o">*</span> <span class="n">pix</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">pix</span><span class="p">):</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">pix_to_ht</span> <span class="o">*</span> <span class="n">pix</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">res</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">numba_impl</span>

    <span class="k">def</span> <span class="nf">make_df_impl_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numba_step_implemented</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Flag to avoid re-compiling</span>
        <span class="n">pix_to_ht</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pix_to_ht</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotates_df</span><span class="p">:</span>
            <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">pix</span><span class="p">):</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">pix_to_ht</span> <span class="o">*</span> <span class="n">pix</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">pix</span><span class="p">):</span>
                <span class="k">return</span> <span class="mf">1.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">numba_impl</span>


    <span class="k">def</span> <span class="nf">make_dfBS_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Rotate the derivatives of the transform, according to the options</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_step</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_dfBS_impl_step</span><span class="p">()</span>
        <span class="n">pix_to_ht</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pix_to_ht</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotates_df</span><span class="p">:</span>
            <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">pix</span><span class="p">):</span>
                <span class="n">ht</span> <span class="o">=</span> <span class="n">pix_to_ht</span> <span class="o">*</span> <span class="n">pix</span>
                <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ht</span><span class="p">)</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">ht</span><span class="p">)</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
                <span class="n">cr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span>
                <span class="n">sr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span>
                <span class="k">return</span>  <span class="o">-</span><span class="n">sr</span><span class="p">,</span> <span class="o">-</span><span class="n">cr</span><span class="p">,</span> <span class="n">cr</span><span class="p">,</span> <span class="o">-</span><span class="n">sr</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">pix</span><span class="p">):</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">pix_to_ht</span> <span class="o">*</span> <span class="n">pix</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">r</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">r</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">numba_impl</span>

    <span class="k">def</span> <span class="nf">make_dfBS_impl_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numba_step_implemented</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Flag to avoid re-compiling</span>
        <span class="n">pix_to_ht</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pix_to_ht</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotates_df</span><span class="p">:</span>
            <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">pix_to_ht</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
                <span class="k">return</span>  <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dfBS</span> <span class="o">=</span> <span class="n">numba_impl</span>

    <span class="k">def</span> <span class="nf">make_dzndc_modifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Applies the scaling part of mapping at end of iteration, so that </span>
<span class="sd">        it is not needed at postproc stage - used for step iterations.</span>
<span class="sd">        (Otherwise we would need to store also step information to disk for </span>
<span class="sd">        image postprocessing stage)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pix_to_ht</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pix_to_ht</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_step</span><span class="p">:</span>
            <span class="n">hshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hmoy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_step_hmoy</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hmoy</span>

        <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">cpix</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">pix_to_ht</span> <span class="o">*</span> <span class="n">cpix</span><span class="p">)</span> <span class="o">+</span> <span class="n">hshift</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dzndc_modifier</span> <span class="o">=</span> <span class="n">numba_impl</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Returns the scaling - for perturbation implementation</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_step</span><span class="p">:</span>
            <span class="n">hmoy_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_step_hmoy</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hmoy_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hmoy</span>
        <span class="k">return</span> <span class="n">mpmath</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">hmoy_df</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bounding_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy_ratio</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This is the scaling of the bounding box for this calculation step</span>
<span class="sd">        ie either the whole image or the current exmpap step sub-image.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_step</span><span class="p">:</span>
            <span class="n">wh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_step_hmax</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hmax</span>

        <span class="n">w</span> <span class="o">=</span> <span class="n">mpmath</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">wh</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">w</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">min_local_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This is the scaling of the minimum pixel due to the projection</span>
<span class="sd">        for the *whole* image (accumulated by steps if activated)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">mpmath</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hmin</span><span class="p">)</span></div>




<span class="c1">#============================================================================== </span>

<div class="viewcode-block" id="Generic_mapping">
<a class="viewcode-back" href="../../API/projection.html#fractalshades.projection.Generic_mapping">[docs]</a>
<span class="k">class</span> <span class="nc">Generic_mapping</span><span class="p">(</span><span class="n">Projection</span><span class="p">):</span>
<div class="viewcode-block" id="Generic_mapping.__init__">
<a class="viewcode-back" href="../../API/projection.html#fractalshades.projection.Generic_mapping.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        This class allows the user to provide a custom mapping defined</span>
<span class="sd">        on the complex plane.</span>

<span class="sd">        The transformation between the complex plane and local pixel</span>
<span class="sd">        coordinates (map :math:`z_{pix}`, according to the zoom level)</span>
<span class="sd">        is managed internally.</span>

<span class="sd">        Known limitations:</span>

<span class="sd">         - currently only differentiable mappings of the</span>
<span class="sd">           complex variable (aka holomorphic / meromorphic functions) are</span>
<span class="sd">           supported.</span>
<span class="sd">         - not suitable for arbitray precision fractals.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        f: numba jitted function numba.complex128 -&gt; numba.complex128</span>
<span class="sd">            The complex function defining the mapping. If a tuple (f1, f2) or</span>
<span class="sd">            (f1, f2, f3) is provided the composition will be applied (f1 o f2)</span>
<span class="sd">        df: numba jitted function numba.complex128 -&gt; numba.complex128</span>
<span class="sd">            The differential of f. If a tuple (df1, df2) or (df1, df2, df3) is</span>
<span class="sd">            provided the differential of the composition will be applied</span>
<span class="sd">            according to the differentiation chain rule.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">f</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>

        <span class="n">_f</span> <span class="o">=</span> <span class="n">f</span> <span class="k">if</span> <span class="n">fs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">is_iterable</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">f</span><span class="p">,)</span>
        <span class="n">_df</span> <span class="o">=</span> <span class="n">df</span> <span class="k">if</span> <span class="n">fs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">is_iterable</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">df</span><span class="p">,)</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_df</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_f</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;len(f) and len(df) shall match&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_func</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_f</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">P_f_numba</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P_df_numba</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_df</span><span class="p">)</span></div>



    <span class="k">def</span> <span class="nf">make_phi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        phi : pixel to C-plane</span>
<span class="sd">        phi_inv: C-plane to pixel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">z_center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_center</span> 
        <span class="n">dx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span>

        <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">numba_phi_impl</span><span class="p">(</span><span class="n">zpix</span><span class="p">):</span>
            <span class="k">return</span>  <span class="n">z_center</span> <span class="o">+</span> <span class="n">zpix</span> <span class="o">*</span> <span class="n">dx</span>

        <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">numba_phi_inv_impl</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span>  <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">z_center</span><span class="p">)</span> <span class="o">/</span> <span class="n">dx</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="n">numba_phi_impl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phi_inv</span> <span class="o">=</span> <span class="n">numba_phi_inv_impl</span>


    <span class="k">def</span> <span class="nf">adjust_to_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fractal</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; JIT compilation is delayed until we know the zoom</span>
<span class="sd">        parameters&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z_center</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">fractal</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">fractal</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="n">fractal</span><span class="o">.</span><span class="n">dx</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">make_phi</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_impl</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">make_f_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">n_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_func</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span>
        <span class="n">phi_inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi_inv</span>
        <span class="n">P_f_numba</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P_f_numba</span>
        
        <span class="k">if</span> <span class="n">n_func</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">f0</span> <span class="o">=</span> <span class="n">P_f_numba</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">numba</span><span class="o">.</span><span class="n">complex128</span><span class="p">(</span><span class="n">numba</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span>
                        <span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">phi</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="c1"># pix -&gt; P</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">f0</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">phi_inv</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span> <span class="c1"># P -&gt; pix</span>
                <span class="k">return</span> <span class="n">zz</span>

        <span class="k">elif</span> <span class="n">n_func</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">f0</span> <span class="o">=</span> <span class="n">P_f_numba</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">f1</span> <span class="o">=</span> <span class="n">P_f_numba</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">numba</span><span class="o">.</span><span class="n">complex128</span><span class="p">(</span><span class="n">numba</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span>
                        <span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">phi</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="c1"># pix -&gt; P</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">f0</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">phi_inv</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span> <span class="c1"># P -&gt; pix</span>
                <span class="k">return</span> <span class="n">zz</span>
            
        <span class="k">elif</span> <span class="n">n_func</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">f0</span> <span class="o">=</span> <span class="n">P_f_numba</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">f1</span> <span class="o">=</span> <span class="n">P_f_numba</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">f2</span> <span class="o">=</span> <span class="n">P_f_numba</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">numba</span><span class="o">.</span><span class="n">complex128</span><span class="p">(</span><span class="n">numba</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span>
                        <span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">phi</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="c1"># pix -&gt; P</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">f0</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">f2</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">phi_inv</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span> <span class="c1"># P -&gt; pix</span>
                <span class="k">return</span> <span class="n">zz</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Composition allowed up to 3 funcs only&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">numba_impl</span>

    <span class="k">def</span> <span class="nf">make_df_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">n_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_func</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span>
        <span class="n">P_f_numba</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P_f_numba</span>
        <span class="n">P_df_numba</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P_df_numba</span>

        <span class="k">if</span> <span class="n">n_func</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df0</span> <span class="o">=</span> <span class="n">P_df_numba</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">numba</span><span class="o">.</span><span class="n">complex128</span><span class="p">(</span><span class="n">numba</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span>
                        <span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">phi</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="c1"># pix -&gt; P</span>
                <span class="n">dzz</span> <span class="o">=</span> <span class="n">df0</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">dzz</span>

        <span class="k">elif</span> <span class="n">n_func</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">df0</span> <span class="o">=</span> <span class="n">P_df_numba</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">f0</span> <span class="o">=</span> <span class="n">P_f_numba</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">df1</span> <span class="o">=</span> <span class="n">P_df_numba</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">numba</span><span class="o">.</span><span class="n">complex128</span><span class="p">(</span><span class="n">numba</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span>
                        <span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">phi</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="c1"># pix -&gt; P</span>
                <span class="n">dzz</span> <span class="o">=</span> <span class="n">df0</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">f0</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="n">dzz</span> <span class="o">*=</span> <span class="n">df1</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">dzz</span>

        <span class="k">elif</span> <span class="n">n_func</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">df0</span> <span class="o">=</span> <span class="n">P_df_numba</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">f0</span> <span class="o">=</span> <span class="n">P_f_numba</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">df1</span> <span class="o">=</span> <span class="n">P_df_numba</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">f1</span> <span class="o">=</span> <span class="n">P_f_numba</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">df2</span> <span class="o">=</span> <span class="n">P_df_numba</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">numba</span><span class="o">.</span><span class="n">complex128</span><span class="p">(</span><span class="n">numba</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span>
                        <span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">phi</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="c1"># pix -&gt; P</span>
                <span class="n">dzz</span> <span class="o">=</span> <span class="n">df0</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">f0</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="n">dzz</span> <span class="o">*=</span> <span class="n">df1</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="n">zz</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="n">dzz</span> <span class="o">*=</span> <span class="n">df2</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">dzz</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Composition allowed up to 3 funcs only&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">numba_impl</span>


    <span class="k">def</span> <span class="nf">make_dfBS_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Currently not implemented, will raise an assertion error if </span>
<span class="sd">        called in LLVM &quot;&quot;&quot;</span>

        <span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">numba_impl</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">assert</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="n">z</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dfBS</span> <span class="o">=</span> <span class="n">numba_impl</span></div>


































</pre></div>

           </div>
          </div>
<div class="ribbon">
  <a href="https://github.com/GBillotey/Fractalshades">Fork me on GitHub</a>
</div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Fractalshades development team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 
<style>
  .wy-nav-content { max-width: 1250px !important; }
</style>


</body>
</html>